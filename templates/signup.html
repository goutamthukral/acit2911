<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="../static/css/styles.css">
    <title>Sign UP</title>
</head>
<body class="signup-body">

   <div class="signup-container">
      <form method="post" action="/login" id="signup-form">
          <h3 class="signup-h3">Sign up here</h3>
          <div class="form-control">
              <label for="studentID">Student ID</label>
              <input type="text" id="studentID" name="studentID" placeholder="Student ID must start with 'A0'">
              <small>Error message</small>
          </div>

          <div class="form-control">
              <label for="email">Email</label>
              <input type="text" id="email" name="email" placeholder="user@my.bcit.ca">
              <small>Error message</small>
          </div>

          <div class="form-control">
              <label for="password">Password</label>
              <input type="password" id="password" name="password" placeholder="Enter password">
              <small>Error message</small>
          </div>

          <div class="form-control">
              <label for="password2">Confirm Password</label>
              <input type="password" id="password2" placeholder="Re-enter password">
              <small>Error message</small>
          </div>

          <input type="submit" name="tumba" value="Sign Up">
      </form>
    </div>

    <script>

        const form = document.getElementById('signup-form');
        const studentID = document.getElementById('studentID');
        const email = document.getElementById('email');
        const password = document.getElementById('password');
        const password2 = document.getElementById('password2');


        //show error message
        function showError(input,message){
            const formControl = input.parentElement;
            formControl.className = 'form-control error';
            const small = formControl.querySelector('small');
            small.innerText = message;
        }

        //show success message
        function showSuccess(input){
            const formControl = input.parentElement;
            formControl.className = 'form-control success';
        }

        // check require field
        function checkRequire(inputArr){
            inputArr.forEach(function(input){
            if(input.value.trim() === ''){
                showError(input, 'Reconfirm your password');
            }
            else {
                showSuccess(input);
            }
            });

        }

        // Get FieldName
        function getFieldName(input){
            return input.id.charAt(0).toUpperCase() + input.id.slice(1);
        }

        // check email validation
        function checkEmail(input){
            const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;

            if(re.test(input.value.trim())){
                showSuccess(input);
            }
            else {
                showError(input, 'Email is not valid');
            }
        }

        // check length
        function checkLength(input, min, max){
            if(input.value.length < min){
                showError(input, `${getFieldName(input)} must be ${min} characters` );
            }else if(input.value.length > max) {
                showError(input, `${getFieldName(input)} must be ${max} characters` );
            }
            else {
                showSuccess(input);
            }
        }


        function checkPwLength(input, min, max){
            if(input.value.length < min){
                showError(input, `${getFieldName(input)} must be at least ${min} characters` );
            }else if(input.value.length > max) {
                showError(input, `${getFieldName(input)} must be less than  ${max} characters` );
            }
            else {
                showSuccess(input);
            }
        }
        

        // check Student ID 
        // function checkID(input) {
        //     const reg = /^(?=[A0])[0-9]*$/;
        //         if(reg.test(input.value.trim())){
        //             showSuccess(input)
        //         }
        //         else {
        //             showError(input, `${getFieldName(input)} must start with 'A0'`)
        //         }
            // if(input.value != "A0"){
            //     showError(input, `${getFieldName(input)} must start with 'A0'`);
            // }


        //check password match
        function checkPasswordMatch(input1, input2){
            if(input1.value !== input2.value){
                showError(input2, 'Password do no match');
            }
        }

        form.addEventListener('submit', function(e){
            e.preventDefault();
            checkRequire([studentID, email, password, password2]);
            checkLength(studentID,9,9);
            checkPwLength(password,8,20);
            // checkID(studentID)
            checkEmail(email);
            checkPasswordMatch(password , password2);
        });

    </script>

</body>
</html>
